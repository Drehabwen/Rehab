# 语音转病例助手

## 项目简介

语音转病例助手是一款面向医疗工作者的智能病历生成工具，通过语音识别技术帮助医生快速创建结构化病历，大幅提高诊疗效率。

### 核心功能

- **实时语音转录**：基于讯飞IAT API，支持中文语音实时转文字
- **智能病例结构化**：自动识别主诉、现病史、既往史、诊断等关键信息
- **病例管理**：本地存储病例数据，支持查询、编辑、删除
- **Word导出**：一键生成标准化Word病历文档
- **简洁GUI**：基于tkinter的直观操作界面

## 技术栈

- **语言**：Python 3.10+
- **GUI框架**：tkinter
- **语音识别**：讯飞IAT API (WebSocket)
- **音频处理**：PyAudio
- **文档生成**：python-docx
- **数据存储**：本地JSON文件

## 快速开始

### 环境要求

- Windows 10/11
- Python 3.10+
- 麦克风设备
- 网络连接

### 安装步骤

1. 克隆或下载项目到本地

2. 创建虚拟环境（推荐）
```bash
python -m venv venv
venv\Scripts\activate
```

3. 安装依赖
```bash
pip install -r requirements.txt
```

4. 配置应用

编辑 `config.json` 文件，设置医院名称和医生姓名：
```json
{
  "hospital_name": "您的医院名称",
  "doctor_name": "您的姓名"
}
```

5. 启动应用
```bash
python main.py
```

## 项目结构

```
AIsci/
├── main.py                    # 主程序入口（GUI）
├── voice.py                   # 语音转录模块
├── case_structurer.py         # 病例结构化模块
├── case_manager.py            # 数据管理模块
├── document_generator.py      # 文档生成模块
├── config.json                # 应用配置
├── cases/                     # 病例JSON存储目录
│   ├── index.json            # 病例索引
│   └── *.json                # 各病例文件
├── exports/                   # Word文档导出目录
├── requirements.txt           # 依赖列表
├── README.md                  # 项目说明
└── 用户手册.md                # 用户使用手册
```

## 使用指南

详细使用说明请参考 [用户手册.md](用户手册.md)

### 基本流程

1. 点击"开始录音"进行语音录入
2. 系统实时转录语音为文字
3. 点击"结构化病例"自动提取关键信息
4. 编辑和完善病例信息
5. 点击"保存病例"存储数据
6. 点击"导出Word"生成标准文档

### 录音技巧

建议按照以下结构进行语音录入以获得最佳效果：

```
患者姓名：XXX，性别：X，年龄：XX岁
主诉：头痛3天
现病史：患者3天前无明显诱因出现头痛...
既往史：高血压病史5年
过敏史：无
体格检查：T 36.5℃，BP 140/90mmHg...
诊断：高血压病
治疗建议：继续降压治疗，监测血压
```

## API配置

语音识别功能使用讯飞IAT API，需要配置以下信息（已在 `voice.py` 中配置）：

- `APPID`：应用ID
- `API_KEY`：API密钥
- `API_SECRET`：API密钥

如需更换API密钥，请编辑 `voice.py` 文件。

## 数据格式

### 病例数据结构

```json
{
  "case_id": "20260124_001",
  "patient_name": "张三",
  "gender": "男",
  "age": 45,
  "visit_date": "2026-01-24",
  "chief_complaint": "头痛3天",
  "present_illness": "患者3天前无明显诱因出现头痛...",
  "past_history": "高血压病史5年",
  "allergies": "青霉素过敏",
  "physical_exam": "T 36.5℃，BP 140/90mmHg",
  "diagnosis": "高血压病",
  "treatment_plan": "继续降压治疗，监测血压"
}
```

## 开发计划

### MVP v1.0 (当前版本)

- [x] 实时语音转录
- [x] 病例结构化
- [x] 本地数据存储
- [x] Word文档导出
- [x] 基础GUI界面

### 未来迭代

- [ ] 云端数据同步
- [ ] 多用户支持
- [ ] 病例模板管理
- [ ] AI辅助诊断
- [ ] 移动端适配（小程序/APK）
- [ ] 语音识别准确率优化

## 常见问题

### 录音无法开始

检查麦克风是否正常工作，确保系统音频权限已开启。

### 转录为空

确保网络连接稳定，讯飞API需要网络支持。

### 结构化不准确

建议使用规范的语音结构，系统会自动识别关键字段。

## 许可证

本项目仅供学习和研究使用。

## 联系方式

如有问题或建议，欢迎反馈。
