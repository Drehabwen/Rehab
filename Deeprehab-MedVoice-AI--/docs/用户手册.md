# 语音转病例助手 - 用户手册

## 产品简介

语音转病例助手是一款帮助医生通过语音快速生成结构化病历的工具。通过语音录入，系统自动将语音转录为文字，并智能识别病例关键信息，最终导出标准化的Word文档。

## 系统要求

- 操作系统：Windows 10/11
- Python 3.10+
- 麦克风设备
- 网络连接（用于讯飞语音识别API）

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置应用

编辑 `config.json` 文件，设置医院名称和医生姓名：

```json
{
  "hospital_name": "您的医院名称",
  "doctor_name": "您的姓名",
  "audio_sample_rate": 16000,
  "audio_channels": 1,
  "cases_dir": "./cases",
  "exports_dir": "./exports"
}
```

### 3. 启动应用

```bash
python main.py
```

## 功能使用

### 主界面

主界面分为三个区域：
- **语音转录区**：录音控制和转录文字显示
- **病例信息区**：结构化病例表单
- **历史病例区**：历史病例列表

### 录音转写

1. 点击"开始录音"按钮开始语音录入
2. 对着麦克风讲述病历信息
3. 点击"停止录音"结束录音
4. 转录结果会实时显示在文本框中

### 病例结构化

1. 录音完成后，点击"结构化病例"按钮
2. 系统会自动从转录文字中提取关键信息
3. 检查并修正结构化结果
4. 填写必填字段（患者姓名、诊断等）

### 保存病例

1. 完善病例信息后，点击"保存病例"按钮
2. 系统会自动生成病例编号并保存到本地
3. 病例会出现在历史病例列表中

### 导出Word文档

1. 确保病例已保存
2. 点击"导出Word"按钮
3. 系统会自动生成标准化病历文档
4. 文档会自动打开供查看和打印

### 历史病例管理

- **查看病例**：双击历史列表中的病例可加载到编辑区
- **删除病例**：选中病例后点击"删除病例"按钮
- **刷新列表**：点击"刷新列表"按钮更新病例列表

## 录音技巧

### 语音结构建议

为了获得更好的结构化效果，建议按照以下结构进行语音录入：

```
患者姓名：XXX，性别：X，年龄：XX岁
主诉：...
现病史：...
既往史：...
过敏史：...
体格检查：...
诊断：...
治疗建议：...
```

### 录音注意事项

1. 在安静环境中录音，减少背景噪音
2. 语速适中，发音清晰
3. 使用专业术语时确保发音准确
4. 录音时保持麦克风距离适当

## 疑难解答

### 录音无法开始

- 检查麦克风是否连接并正常工作
- 检查系统音频设置，确保麦克风权限已开启
- 检查网络连接，讯飞API需要网络支持

### 转录为空

- 确保录音时有声音输入
- 检查网络连接是否稳定
- 尝试重新录音

### 结构化不准确

- 使用规范的语音结构
- 手动编辑识别不准确的信息
- 确保语音内容包含完整的关键信息

### 导出失败

- 检查磁盘空间是否充足
- 确保 `exports` 目录有写入权限
- 检查病例数据是否完整

## 数据备份

所有病例数据保存在 `cases` 目录下的JSON文件中：

- `index.json`：病例索引文件
- `YYYYMMDD_XXX.json`：具体病例文件

建议定期备份 `cases` 目录。

## 技术支持

如遇到问题，请检查：
1. Python版本是否符合要求
2. 所有依赖包是否正确安装
3. 麦克风设备是否正常工作
4. 网络连接是否稳定

## 更新日志

### v1.0 (2026-01-24)
- 初始版本发布
- 支持实时语音转录
- 支持病例结构化
- 支持病例保存和导出
